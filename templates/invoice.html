<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invoice {{ income.invoice_number }}</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .invoice-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    
    .header {
      text-align: center;
      border-bottom: 3px solid #3b82f6;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }
    
    .company-name {
      font-size: 32px;
      font-weight: 700;
      color: #1e40af;
      margin-bottom: 10px;
    }
    
    .company-info {
      color: #6b7280;
      font-size: 14px;
      line-height: 1.8;
    }
    
    .invoice-title {
      font-size: 28px;
      font-weight: 700;
      color: #1f2937;
      margin: 30px 0 20px;
      text-align: center;
    }
    
    .invoice-meta {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
      background: #f9fafb;
      padding: 20px;
      border-radius: 8px;
    }
    
    .meta-item {
      padding: 10px 0;
    }
    
    .meta-label {
      font-weight: 600;
      color: #4b5563;
      font-size: 14px;
      margin-bottom: 5px;
    }
    
    .meta-value {
      color: #1f2937;
      font-size: 16px;
    }
    
    .customer-section {
      background: #eff6ff;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
    
    .section-title {
      font-weight: 700;
      color: #1e40af;
      font-size: 18px;
      margin-bottom: 10px;
    }
    
    .details-table {
      width: 100%;
      border-collapse: collapse;
      margin: 30px 0;
    }
    
    .details-table th {
      background: #3b82f6;
      color: white;
      padding: 15px;
      text-align: right;
      font-weight: 600;
    }
    
    .details-table td {
      padding: 15px;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .total-section {
      margin-top: 30px;
      text-align: left;
      background: #10b981;
      color: white;
      padding: 20px;
      border-radius: 8px;
    }
    
    .total-label {
      font-size: 20px;
      font-weight: 600;
    }
    
    .total-amount {
      font-size: 32px;
      font-weight: 700;
      margin-top: 10px;
    }
    
    .footer {
      margin-top: 50px;
      padding-top: 20px;
      border-top: 2px solid #e5e7eb;
      text-align: center;
      color: #6b7280;
      font-size: 13px;
    }
    
    .legal-info {
      background: #fef3c7;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
      border: 2px solid #fbbf24;
    }
    
    .legal-title {
      font-weight: 700;
      color: #92400e;
      margin-bottom: 10px;
      font-size: 16px;
    }
    
    .legal-text {
      color: #78350f;
      font-size: 13px;
      line-height: 1.8;
    }
    
    .print-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: #3b82f6;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      font-family: 'Cairo', sans-serif;
    }
    
    .print-button:hover {
      background: #2563eb;
    }
    
    @media print {
      body {
        background: white;
        padding: 0;
      }
      
      .invoice-container {
        box-shadow: none;
        padding: 20px;
      }
      
      .print-button {
        display: none;
      }
    }
  </style>
</head>
<body>
  <button class="print-button" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
  
  <div class="invoice-container">
    <!-- Header -->
    <div class="header">
      <div class="company-name">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" viewBox="0 0 16 16" style="vertical-align: middle;">
          <path d="M4 11a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm8 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zM3 5.5A1.5 1.5 0 0 1 4.5 4h7A1.5 1.5 0 0 1 13 5.5v5a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 10.5v-5zM4.5 5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-7z"/>
        </svg>
        Auto Protect
      </div>
      <div class="company-info">
        Ø®Ø¯Ù…Ø§Øª ØªØºÙ„ÙŠÙ ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª<br>
        Car Wrapping & Protection Services<br>
        ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§ÙƒØ§Ø¯ÙŠØ± Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø­Ù…Ø¯ÙŠØ©<br>
        ğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: +212661225829 | ÙˆØ§ØªØ³Ø§Ø¨: +212661225829
      </div>
    </div>
    
    <!-- Invoice Title -->
    <div class="invoice-title">ÙØ§ØªÙˆØ±Ø© / Invoice</div>
    
    <!-- Invoice Meta -->
    <div class="invoice-meta">
      <div class="meta-item">
        <div class="meta-label">Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© / Invoice Number</div>
        <div class="meta-value">{{ income.invoice_number }}</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Ø§Ù„ØªØ§Ø±ÙŠØ® / Date</div>
        <div class="meta-value">{{ income.date }}</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù / Agent Name</div>
        <div class="meta-value" style="font-weight: 700; color: #1e40af;">
          {{ agent.name if agent else 'N/A' }}
          {% if agent and agent.phone %}<br><small style="font-size: 12px;">ğŸ“ {{ agent.phone }}</small>{% endif %}
        </div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Ø§Ù„Ù…ØµØ¯Ø± / Source</div>
        <div class="meta-value">{{ income.source or '-' }}</div>
      </div>
    </div>
    
    <!-- Customer Section -->
    <div class="customer-section">
      <div class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ / Customer Information</div>
      <div style="margin-top: 10px;">
        <strong>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ / Customer Name:</strong> {{ income.customer_name or 'N/A' }}<br>
        <strong>Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© / Car Type:</strong> {{ income.car_type or 'N/A' }}
      </div>
    </div>
    
    <!-- Service Details -->
    <table class="details-table">
      <thead>
        <tr>
          <th>Ø§Ù„ÙˆØµÙ / Description</th>
          <th>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø© / Service Type</th>
          <th>Ø§Ù„Ù…Ø¨Ù„Øº / Amount</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ income.note or 'Ø®Ø¯Ù…Ø© ØªØºÙ„ÙŠÙ Ø³ÙŠØ§Ø±Ø© ÙƒØ§Ù…Ù„Ø©' }}</td>
          <td><strong>{{ income.service_type or 'N/A' }}</strong></td>
          <td style="font-weight: 700; font-size: 18px;">{{ "%.2f"|format(income.amount) }} Ø¯Ø±Ù‡Ù… (MAD)</td>
        </tr>
      </tbody>
    </table>
    
    <!-- Total -->
    <div class="total-section">
      <div class="total-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ / Total Amount</div>
      <div class="total-amount">{{ "%.2f"|format(income.amount) }} Ø¯Ø±Ù‡Ù…</div>
      <div style="margin-top: 10px; font-size: 14px;">Ø¯Ø±Ù‡Ù… Ù…ØºØ±Ø¨ÙŠ / Moroccan Dirham (MAD)</div>
    </div>
    
    <!-- Legal Info -->
    <div class="legal-info">
      <div class="legal-title">âš–ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© / Legal Information</div>
      <div class="legal-text">
        <strong>â€¢ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ:</strong> ICE XXXXXXXXXXXX<br>
        <strong>â€¢ Ø±Ù‚Ù… Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ:</strong> RC XXXXXX<br>
        <strong>â€¢ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> Ù†Ù‚Ø¯Ø§Ù‹ / ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ<br>
        <strong>â€¢ Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙØ¹:</strong> Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…<br>
        <strong>â€¢ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (TVA):</strong> 20%<br>
        <br>
        <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØµØ§Ù„Ø­Ø© ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…ØºØ±Ø¨ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù‡Ø§ Ù„Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©.
      </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
      Ø´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒÙ… Ø¨Ù†Ø§ / Thank you for your business<br>
      Â© 2025 Auto Protect Database. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
    </div>
  </div>
</body>
</html>
